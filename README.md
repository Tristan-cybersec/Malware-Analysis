### - Coded this a while ago just to test out how malware analysis works, Really cool hope it helps you understand more as well!!








Malware analysis

Objective

The goal of this project is to perform static analysis on a suspicious binary or script file. The analysis includes extracting metadata, strings, and potential indicators of compromise (IoCs) from the malware sample.

Skills Learned 

- Python scripting
- File I/O operations
- Regular expressions
- Static code analysis techniques

Tools Used

- Python
- Virtual Environment (optional)
- Regex libraries
- Hashing libraries (e.g., hashlib)


Step-by-step images


Ref 1 - Importing Required Modules



![Importing Required Modules](https://github.com/user-attachments/assets/05714aa1-1a48-4559-87cc-04bd10eb1b90)




- ' os '- The functions interacting with the operating system, such as checking file existence.
- ' hashlib '- Used for creating hash values (SHA-256 or MD5) for files, which is crucial in identifying malware.
- ' re '- Provides support for regular expressions, which are used to search for patterns in strings (IP addresses, URLs).






Ref 2 - Hash Calculation Function



![hash calculation fuction](https://github.com/user-attachments/assets/4f3130d5-2196-41fc-9905-9435b6874128)



- ' hash_function '-  Dynamically selects the hash function based on hash_type ('sha256', 'md5').
- ' open(file_path, 'rb') '- Opens the file in binary mode to read its contents.
- ' chunk := f.read(8192) '- Reads the file in chunks of 8192 bytes to avoid loading large files into memory simultaneously.
- ' hash_function.update(chunk) '-  Continuously updates the hash function with chunks of the file.
- ' return hash_function.hexdigest() '- Returns the final hash value as a hexadecimal string.






Ref 3 - String Extraction Function





![string extraction function](https://github.com/user-attachments/assets/5cd1ee9b-8057-4c76-b3e9-9f80f89aec2d)





- ' open(file_path, 'rb') '- Opens the file in binary mode.
- ' content = f.read() '- Reads the entire file into memory.
- ' pattern = re.compile(...) '- Compiles a regular expression that matches sequences of printable ASCII characters (ranging from 0x20 to 0x7E).
- ' pattern.findall(content) '- Finds all matching sequences in the file content.
- ' s.decode('utf-8', errors='ignore') '- Decodes the binary strings into UTF-8 encoded text, ignoring errors if any characters






Ref 4 - Indicator of Compromise (IoC) Detection Function





![Indicator of Compromise (IoC) Detection Function](https://github.com/user-attachments/assets/39837c29-5336-4a4f-8354-36ffcd19c8a5)





- ' iocs '- Initializes a dictionary to store detected IoCs.
- ' ip_pattern, url_pattern, suspicious_filename_pattern'- Compile regular expressions to detect specific patterns (IP addresses, URLs, filenames).
- ' for s in strings: '- Loops through each extracted string.
- ' iocs['IP Addresses'].extend(ip_match) '- If an IP address is found, it is added to the IoCs dictionary.
- The same process is applied for URLs and suspicious filenames.


Ref 5 - Main Analysis Function





![Main Analysis Function](https://github.com/user-attachments/assets/813340cf-a346-4dc7-a632-bf23354ee720)




- ' print(f"Analyzing file: {file_path}") '- Outputs the name of the file being analyzed.
- ' calculate_hash(...) '- Calculates and prints the SHA-256 and MD5 hash values.
- ' strings = extract_strings(file_path) '- Extracts and counts the strings found in the file.
- ' iocs = find_iocs(strings) '- Finds IoCs within the extracted strings and prints them.


Ref 6 - Execution Block




![Execution Block](https://github.com/user-attachments/assets/c9a53f26-1992-463f-a94c-fb58c7ba446d)



- ' sample_file = "suspicious_sample.exe" '- Specifies the file to analyze.
- ' os.path.isfile(sample_file) '- Checks if the specified file exists.
- ' If the file exists, it calls analyze_file(sample_file) to start the analysis.




